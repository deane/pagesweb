<!DOCTYPE html>
<html lang="fr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyse Interactive: Kits Solaires Plug & Play en France</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Application Structure Plan: 
        The SPA is structured thematically to guide the user through the report's content logically, rather than mirroring the report's linear chapter structure.
        1.  Hero Section: Title and brief intro.
        2.  Navigation Bar: Sticky, for easy access to key sections.
        3.  Le March√© en Bref: Key statistics (market growth, price ranges) for a quick overview.
        4.  Comprendre les Kits: Explains what plug-and-play kits are, their components (using HTML/CSS for simple diagrams/icons), advantages, and limitations (interactive toggles/tabs).
        5.  Acteurs Cl√©s: Presentation of main manufacturers and distributors (e.g., using cards, possibly with simple JS filtering if time allows).
        6.  Au C≈ìur du Produit: Interactive deep dive into fixation systems (cards for each type), panel power/technology (charts for power distribution, tech types), and microinverters.
        7.  Comparatif de Kits: Interactive HTML table for the detailed kit comparison from the report.
        8.  Analyse des Prix: Charts for ‚Ç¨/Wc, list of price factors, ROI insights.
        9.  R√©glementation: HTML/CSS flowchart for administrative steps, clear explanation of NF C15-100, safety tips. Includes Gemini-powered regulatory assistant.
        10. Guide d'Achat: Interactive checklist/criteria. Includes Gemini-powered selection assistant.
        11. Conclusion & Perspectives: Summary.
        This structure is chosen for usability, allowing users to jump to sections of interest or follow a guided exploration. Interactions like clickable cards, charts, and AI assistants aim to make data digestion easier and more personalized.
    -->
    <!-- Visualization & Content Choices: 
        - Market Growth: Bar Chart (Chart.js) - Goal: Change - Justification: Clear visual for trend.
        - Kit Components/Fixation Types: HTML/CSS Cards with Unicode icons - Goal: Inform/Organize - Justification: Visual and textual information, no complex data.
        - Panel Power Distribution: Bar Chart (Chart.js) - Goal: Compare - Justification: Easy comparison of power categories.
        - Panel Technologies: Donut Chart (Chart.js) - Goal: Compare (proportion) - Justification: Shows share of different technologies.
        - Price/Wc Comparison: Bar Chart (Chart.js) - Goal: Compare - Justification: Direct comparison of value metric.
        - Regulatory Steps: HTML/CSS Flowchart - Goal: Organize - Justification: Visual representation of a process.
        - Kit Comparison Table: HTML Table - Goal: Compare/Organize - Justification: Detailed data presentation.
        - Gemini API for "Guide d'Achat": User inputs details -> LLM provides personalized advice. Goal: Inform/Personalize. Justification: Tailored guidance.
        - Gemini API for "R√©glementation": User inputs project details -> LLM clarifies administrative steps. Goal: Inform/Personalize. Justification: Simplified regulatory understanding.
        - All textual content from the report, summarized and placed in contextually relevant sections with introductory paragraphs.
        - CONFIRMATION: NO SVG graphics used. NO Mermaid JS used.
    -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF7; 
            color: #3D3D3D; 
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px; 
            margin-left: auto;
            margin-right: auto;
            height: 300px; 
            max-height: 400px; 
            padding: 1rem;
            background-color: #FFFFFF;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .nav-link {
            transition: color 0.3s ease, border-bottom-color 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .nav-link:hover, .nav-link.active {
            color: #795548; 
            border-bottom-color: #795548;
        }
        .section-title {
            color: #795548; 
            border-bottom: 2px solid #A1887F; 
            padding-bottom: 0.5rem;
        }
        .card {
            background-color: #FFFFFF;
            border: 1px solid #E0E0E0;
            border-radius: 0.75rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.12);
        }
        .tab-button {
            background-color: #F1F1F1;
            color: #3D3D3D;
            border: 1px solid #D4BBA1;
        }
        .tab-button.active {
            background-color: #A1887F; 
            color: #FFFFFF;
            border-color: #795548;
        }
        .stat-card {
            background-color: #A1887F; 
            color: #FFFFFF;
        }
        .stat-number {
            color: #FDFBF7;
        }
        .flowchart-step {
            background-color: #E8E0D9; 
            border: 1px solid #A1887F;
            color: #3D3D3D;
        }
        .flowchart-arrow {
            color: #795548;
        }
        .table-header {
            background-color: #A1887F;
            color: #FFFFFF;
        }
        .tooltip-custom {
            background-color: rgba(0,0,0,0.75) !important;
            border-radius: 4px !important;
            color: white !important;
            padding: 8px !important;
        }
        .tooltip-title-custom {
            font-weight: bold !important;
            margin-bottom: 4px !important;
        }
    </style>
</head>
<body class="leading-relaxed">

    <header class="bg-[#A1887F] text-white py-6 shadow-md">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-3xl md:text-4xl font-bold">Kits Solaires Plug & Play en France (800-1000W)</h1>
            <p class="mt-2 text-lg">Analyse Interactive du March√©, Produits & R√©glementation</p>
        </div>
    </header>

    <nav id="navbar" class="sticky top-0 z-50 bg-[#FDFBF7] shadow-lg">
        <div class="container mx-auto px-4">
            <div class="flex flex-wrap justify-center items-center py-3 text-sm md:text-base">
                <a href="#accueil" class="nav-link px-3 py-2 font-semibold">Accueil</a>
                <a href="#marche-apercu" class="nav-link px-3 py-2 font-semibold">March√©</a>
                <a href="#comprendre-kits" class="nav-link px-3 py-2 font-semibold">Les Kits</a>
                <a href="#acteurs-cles" class="nav-link px-3 py-2 font-semibold">Acteurs</a>
                <a href="#produits-detail" class="nav-link px-3 py-2 font-semibold">Produits</a>
                <a href="#comparatif-kits" class="nav-link px-3 py-2 font-semibold">Comparatif</a>
                <a href="#analyse-prix" class="nav-link px-3 py-2 font-semibold">Prix</a>
                <a href="#reglementation" class="nav-link px-3 py-2 font-semibold">R√©glementation</a>
                <a href="#guide-achat" class="nav-link px-3 py-2 font-semibold">Guide d'Achat</a>
            </div>
        </div>
    </nav>

    <main class="container mx-auto p-4 md:p-8">

        <section id="accueil" class="pt-16 -mt-16 mb-12 text-center">
            <p class="text-lg max-w-3xl mx-auto">Bienvenue dans cette analyse interactive du march√© fran√ßais des syst√®mes solaires "plug-and-play". Explorez les tendances, les produits, les prix et les aspects r√©glementaires pour mieux comprendre ce secteur en pleine √©volution. Cette application vise √† rendre les informations du rapport de recherche plus accessibles et digestes, avec d√©sormais des assistants IA pour vous guider.</p>
        </section>

        <section id="marche-apercu" class="pt-16 -mt-16 mb-12">
            <h2 class="text-2xl md:text-3xl font-bold mb-6 section-title">Le March√© en Bref</h2>
            <p class="mb-6 text-gray-700">Le march√© des kits solaires plug-and-play en France est dynamique, marqu√© par une croissance notable et une offre de produits vari√©e. Ces syst√®mes, faciles √† installer, attirent de plus en plus de consommateurs souhaitant r√©duire leur facture √©nerg√©tique. Cependant, des √©volutions r√©glementaires r√©centes soul√®vent des questions importantes pour l'avenir du secteur.</p>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <div class="stat-card p-6 rounded-lg shadow-lg">
                    <div class="text-5xl font-bold stat-number">30%</div>
                    <div class="mt-2 text-lg">Croissance du march√© en 2023 (source: Planete Business)</div>
                </div>
                <div class="stat-card p-6 rounded-lg shadow-lg">
                    <div class="text-3xl font-bold stat-number">500‚Ç¨ - 1600‚Ç¨+</div>
                    <div class="mt-2 text-lg">Fourchette de prix typique (kits 800-1000W, 2 panneaux)</div>
                </div>
                <div class="stat-card p-6 rounded-lg shadow-lg">
                    <div class="text-3xl font-bold stat-number">0.50‚Ç¨ - 1.50‚Ç¨+</div>
                    <div class="mt-2 text-lg">Prix par Watt cr√™te (‚Ç¨/Wc)</div>
                </div>
            </div>
            <div class="card p-6">
                <h3 class="text-xl font-semibold mb-3 text-[#795548]">Points Cl√©s du R√©sum√© Ex√©cutif :</h3>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li>L'offre de produits est vari√©e, avec des diff√©rences notables sur la puissance des panneaux (400-500Wc/panneau) et les technologies (monocristallin, bifacial, TOPCon).</li>
                    <li>Les syst√®mes de fixation (sol, mur, balcon) sont un crit√®re de diff√©renciation majeur, impactant facilit√© d'installation et adaptabilit√©.</li>
                    <li>La norme NF C15-100 (applicable en sept. 2025) pourrait interdire la connexion directe sur prise standard, cr√©ant une incertitude.</li>
                    <li>La d√©claration √† Enedis (CACSI) reste obligatoire pour l'autoconsommation.</li>
                </ul>
            </div>
        </section>

        <section id="comprendre-kits" class="pt-16 -mt-16 mb-12">
            <h2 class="text-2xl md:text-3xl font-bold mb-6 section-title">Comprendre les Kits Solaires Plug & Play</h2>
            <p class="mb-6 text-gray-700">Ces syst√®mes sont con√ßus pour une installation simplifi√©e, permettant aux particuliers de produire leur propre √©lectricit√©. Voici un aper√ßu de leurs caract√©ristiques, composants, avantages et limites.</p>
            <div class="card p-6 mb-8">
                <h3 class="text-xl font-semibold mb-4 text-[#795548]">Caract√©ristiques et Composants Typiques (Kit 2 panneaux, 800-1000W)</h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <p class="mb-2"><strong class="text-gray-800">üîå Simplicit√© de connexion :</strong> Se branche sur une prise domestique standard.</p>
                        <p class="mb-2"><strong class="text-gray-800">üõ†Ô∏è Auto-installation :</strong> Con√ßu pour √™tre install√© par l'utilisateur.</p>
                        <p class="mb-2"><strong class="text-gray-800">üì± Suivi de production :</strong> Souvent via application mobile (Wi-Fi).</p>
                    </div>
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">Composants cl√©s :</h4>
                        <ul class="list-none space-y-2">
                            <li class="flex items-center"><span class="text-2xl mr-2">‚òÄÔ∏è</span> Deux panneaux solaires (400-500Wc chacun)</li>
                            <li class="flex items-center"><span class="text-2xl mr-2">üîÑ</span> Un ou deux micro-onduleurs (convertit DC en AC)</li>
                            <li class="flex items-center"><span class="text-2xl mr-2">üî©</span> Syst√®me de fixation (sol, mur, balcon, etc.)</li>
                            <li class="flex items-center"><span class="text-2xl mr-2">üîó</span> C√¢blage et prise secteur</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="card p-6">
                <div class="flex border-b border-gray-300 mb-4">
                    <button class="tab-button flex-1 py-2 px-4 rounded-t-lg font-semibold active" onclick="openTab(event, 'avantages')">Avantages</button>
                    <button class="tab-button flex-1 py-2 px-4 rounded-t-lg font-semibold" onclick="openTab(event, 'limitations')">Limitations</button>
                </div>
                <div id="avantages" class="tab-content">
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>Facilit√© et rapidit√© d'installation.</li>
                        <li>Portabilit√© (id√©al pour locataires).</li>
                        <li>Accessibilit√© pour divers logements (jardin, balcon, terrasse).</li>
                        <li>Investissement initial plus faible que les installations traditionnelles.</li>
                        <li>Autoconsommation imm√©diate, r√©duction de la facture.</li>
                    </ul>
                </div>
                <div id="limitations" class="tab-content hidden">
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>Production d'√©nergie limit√©e (couvre le "talon de consommation").</li>
                        <li>G√©n√©ralement pas de revente du surplus d'√©lectricit√©.</li>
                        <li>Souvent in√©ligible √† certaines aides d'√âtat (car auto-install√©).</li>
                        <li>L'installation m√©canique (fixation) demande attention et soin.</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="acteurs-cles" class="pt-16 -mt-16 mb-12">
            <h2 class="text-2xl md:text-3xl font-bold mb-6 section-title">Acteurs Cl√©s du March√© Fran√ßais</h2>
            <p class="mb-6 text-gray-700">Le march√© fran√ßais est anim√© par une vari√©t√© d'acteurs, des fabricants sp√©cialis√©s aux grandes surfaces de bricolage, en passant par les d√©taillants en ligne.</p>
            <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6" id="acteursList">
            </div>
            <p class="mt-4 text-sm text-gray-600">Certains acteurs mettent en avant une production ou un assemblage en France (ex: Sunology, Sunethic, Dualsun), un argument de plus en plus valoris√© par les consommateurs.</p>
        </section>

        <section id="produits-detail" class="pt-16 -mt-16 mb-12">
            <h2 class="text-2xl md:text-3xl font-bold mb-6 section-title">Au C≈ìur du Produit</h2>
            <p class="mb-8 text-gray-700">La performance et la durabilit√© d'un kit solaire plug-and-play d√©pendent grandement de la qualit√© de ses composants. Cette section d√©taille les syst√®mes de fixation, la puissance et la technologie des panneaux, ainsi que les sp√©cifications des micro-onduleurs.</p>

            <div class="mb-10">
                <h3 class="text-xl font-semibold mb-4 text-[#795548]">Syst√®mes de Fixation : Un √âl√©ment Crucial</h3>
                <p class="mb-4 text-gray-600">Le choix du syst√®me de fixation est d√©terminant pour la facilit√© d'installation, la s√©curit√© et l'adaptabilit√© du kit √† votre logement.</p>
                <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4" id="fixationTypes">
                </div>
                <div class="mt-4 grid sm:grid-cols-2 gap-4">
                    <div class="card p-4">
                        <h4 class="font-semibold text-md text-[#795548]">Mat√©riaux courants :</h4>
                        <p class="text-sm">Aluminium (l√©g√®ret√©, r√©sistance), Acier galvanis√© (robustesse).</p>
                    </div>
                    <div class="card p-4">
                        <h4 class="font-semibold text-md text-[#795548]">Ajustabilit√© :</h4>
                        <p class="text-sm">Inclinaison souvent r√©glable pour optimiser la captation solaire.</p>
                    </div>
                </div>
                <p class="mt-4 text-sm text-gray-600">Un syst√®me de fixation inadapt√© ou complexe peut annuler l'avantage de simplicit√© du kit. Les solutions lestables sont simples mais n√©cessitent une surface plane et un lestage ad√©quat. Les fixations murales ou pour toiture peuvent offrir une meilleure orientation mais demandent plus de soin √† l'installation.</p>
            </div>

            <div class="mb-10">
                <h3 class="text-xl font-semibold mb-4 text-[#795548]">Puissance et Technologie des Panneaux</h3>
                <p class="mb-4 text-gray-600">La puissance individuelle des panneaux (typiquement 400Wc √† 500Wc pour les kits 800-1000W) et leur technologie influencent directement la production d'√©nergie.</p>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="chart-container">
                        <canvas id="panelPowerChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="panelTechChart"></canvas>
                    </div>
                </div>
                <div class="card p-6 mt-6">
                     <h4 class="font-semibold text-lg mb-2 text-[#795548]">Technologies de panneaux courantes :</h4>
                    <ul class="list-disc list-inside space-y-1">
                        <li><strong>Monocristallin :</strong> Bon rendement standard.</li>
                        <li><strong>Bifacial :</strong> Capte la lumi√®re des deux c√¥t√©s, potentiel de rendement accru.</li>
                        <li><strong>TOPCon :</strong> Efficacit√© sup√©rieure, meilleure performance √† long terme.</li>
                        <li><strong>Bi-verre :</strong> Durabilit√© accrue.</li>
                    </ul>
                    <p class="mt-2 text-sm text-gray-600">Des panneaux plus puissants individuellement permettent d'atteindre la puissance totale avec une empreinte potentiellement optimis√©e. Les technologies avanc√©es am√©liorent le rendement mais peuvent influencer le prix.</p>
                </div>
            </div>
            
            <div class="card p-6">
                <h3 class="text-xl font-semibold mb-4 text-[#795548]">Micro-Onduleurs et Suivi</h3>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li>Un micro-onduleur double (pour 2 panneaux) ou deux individuels sont courants. Ex: APsystems DS3, Hoymiles HMS.</li>
                    <li>Puissance de sortie adapt√©e √† la puissance cr√™te des panneaux (ex: 800W pour 800-900Wc).</li>
                    <li>Connectivit√© Wi-Fi pour suivi de production via application mobile (tr√®s r√©pandue).</li>
                    <li>Fonction de d√©couplage (anti-√Ælotage) certifi√©e (VDE0126-1-1 / EN50549) imp√©rative pour la s√©curit√©.</li>
                    <li>Garanties variables (10 √† 25 ans). Une garantie longue est un gage de qualit√©.</li>
                </ul>
            </div>
        </section>
        
        <section id="comparatif-kits" class="pt-16 -mt-16 mb-12">
            <h2 class="text-2xl md:text-3xl font-bold mb-6 section-title">Tableau Comparatif de Kits S√©lectionn√©s</h2>
            <p class="mb-6 text-gray-700">Le tableau suivant synth√©tise les caract√©ristiques de plusieurs kits repr√©sentatifs du march√© fran√ßais (800-1000W, 2 panneaux), en se concentrant sur les syst√®mes de fixation et la puissance des panneaux. Ces donn√©es sont indicatives et bas√©es sur le rapport du 23 mai 2025.</p>
            <div class="overflow-x-auto card p-0">
                <table class="min-w-full text-sm text-left">
                    <thead class="table-header">
                        <tr>
                            <th class="p-3">Marque et Mod√®le</th>
                            <th class="p-3">Puissance Totale (Wc)</th>
                            <th class="p-3">Panneaux (Qt√© x Wc & Type)</th>
                            <th class="p-3">Micro-onduleur (W/VA)</th>
                            <th class="p-3">Fixations Propos√©es</th>
                            <th class="p-3">Garanties (Panneau/MO)</th>
                            <th class="p-3">Prix TTC (‚Ç¨) Indic.</th>
                            <th class="p-3">‚Ç¨/Wc Indic.</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200" id="kitComparisonTableBody">
                    </tbody>
                </table>
            </div>
             <p class="mt-4 text-xs text-gray-500">Note : Les prix et sp√©cifications sont indicatifs et peuvent varier. Consulter les fiches produits des vendeurs pour les informations les plus r√©centes.</p>
        </section>

        <section id="analyse-prix" class="pt-16 -mt-16 mb-12">
            <h2 class="text-2xl md:text-3xl font-bold mb-6 section-title">Analyse Comparative des Prix</h2>
            <p class="mb-6 text-gray-700">Les prix des kits varient consid√©rablement. Cette section explore la fourchette de prix, le co√ªt par Watt cr√™te (‚Ç¨/Wc), les facteurs d'influence et les d√©lais de rentabilit√© annonc√©s.</p>
            <div class="grid md:grid-cols-2 gap-6 items-start">
                <div class="card p-6">
                    <h3 class="text-xl font-semibold mb-3 text-[#795548]">Facteurs Influant sur les Prix :</h3>
                    <ul class="list-disc list-inside space-y-1 text-sm text-gray-700">
                        <li>R√©putation de la marque et origine (France/Europe vs. import).</li>
                        <li>Technologie des panneaux (bifacial, TOPCon, bi-verre co√ªtent plus cher).</li>
                        <li>Qualit√© et polyvalence du syst√®me de fixation.</li>
                        <li>Marque et dur√©e de garantie du micro-onduleur (20-25 ans est un plus).</li>
                        <li>Accessoires inclus (c√¢bles longs, suivi avanc√©).</li>
                        <li>Dur√©es des garanties g√©n√©rales.</li>
                    </ul>
                    <p class="mt-3 text-sm text-gray-600">Le ratio ‚Ç¨/Wc est utile, mais la qualit√© globale, les garanties et l'ad√©quation du syst√®me de fixation sont cruciales pour la valeur √† long terme.</p>
                </div>
                <div class="chart-container">
                    <canvas id="pricePerWcChart"></canvas>
                </div>
            </div>
            <div class="card p-6 mt-6">
                <h3 class="text-xl font-semibold mb-3 text-[#795548]">D√©lais de Rentabilit√© Annonc√©s :</h3>
                <p class="text-gray-700">G√©n√©ralement entre <strong>3 et 7 ans</strong>. L'ADEME sugg√®re 4-5 ans pour un kit de 0.8 kWc avec 100% d'autoconsommation. Cela d√©pend fortement du prix de l'√©lectricit√©, du taux d'autoconsommation r√©el et de l'ensoleillement.</p>
            </div>
        </section>

        <section id="reglementation" class="pt-16 -mt-16 mb-12">
            <h2 class="text-2xl md:text-3xl font-bold mb-6 section-title">Consid√©rations R√©glementaires et d'Installation</h2>
            <p class="mb-6 text-gray-700">L'installation, m√™me simplifi√©e, est soumise √† des r√®gles pour assurer s√©curit√© et conformit√©.</p>
            
            <div class="card p-6 mb-8">
                <h3 class="text-xl font-semibold mb-4 text-center text-[#795548]">D√©marches Administratives Cl√©s</h3>
                <div class="space-y-4">
                    <div class="flowchart-step p-3 rounded-md shadow">
                        <strong class="block text-lg">1. D√©claration Pr√©alable en Mairie ?</strong>
                        <p class="text-sm">NON si au sol &lt;1.80m ET &lt;3kWc. OUI si >1.80m ou >3kWc (CERFA 13703).</p>
                    </div>
                    <div class="text-center flowchart-arrow text-2xl">‚¨áÔ∏è</div>
                    <div class="flowchart-step p-3 rounded-md shadow">
                        <strong class="block text-lg">2. D√©claration √† Enedis (CACSI)</strong>
                        <p class="text-sm">OBLIGATOIRE pour autoconsommation. En ligne, certificat onduleur requis (VDE0126-1-1 / EN50549).</p>
                    </div>
                    <div class="text-center flowchart-arrow text-2xl">‚¨áÔ∏è</div>
                    <div class="flowchart-step p-3 rounded-md shadow">
                        <strong class="block text-lg">3. CONSUEL n√©cessaire ?</strong>
                        <p class="text-sm">NON si kit &lt;3kVA branch√© sur prise existante, sans batterie, sans modif. installation fixe. OUI si >3kVA, batterie, modif. tableau, revente surplus.</p>
                    </div>
                </div>
            </div>

            <div class="card p-6 border-2 border-[#FF6B6B] bg-red-50">
                <h3 class="text-xl font-bold mb-3 text-center text-red-600">‚ö†Ô∏è Attention : √âvolution Norme NF C15-100</h3>
                <p class="text-center text-gray-800">
                    Une mise √† jour (applicable obligatoirement en septembre 2025) pourrait <strong class="text-red-700">interdire le branchement d'un g√©n√©rateur sur un circuit terminal via une simple prise de courant</strong>.
                </p>
                <p class="text-center mt-2 text-gray-700">
                    Cela cr√©e une incertitude pour les kits "plug-and-play". Les fabricants et instances professionnelles cherchent des clarifications.
                    <strong class="block mt-1">Renseignez-vous aupr√®s de votre vendeur sur la conformit√© et les recommandations futures.</strong>
                </p>
            </div>

            <div class="card p-6 mt-8">
                <h3 class="text-xl font-semibold mb-4 text-[#795548]">‚ú® Assistant R√©glementaire Simplifi√©</h3>
                <p class="text-gray-600 mb-4">Des doutes sur les d√©marches administratives ? D√©crivez votre projet et notre assistant IA vous aidera √† y voir plus clair.</p>
                <div class="space-y-4 mb-4">
                    <div>
                        <label for="gemini-reg-installation" class="block text-sm font-medium text-gray-700">Type d'installation pr√©vu :</label>
                        <select id="gemini-reg-installation" name="gemini-reg-installation" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-[#A1887F] focus:border-[#A1887F]">
                            <option value="sol_moins_1.8m_et_moins_3kWc">Au sol, hauteur < 1.80m ET puissance totale < 3kWc</option>
                            <option value="sol_plus_1.8m_ou_plus_3kWc">Au sol, hauteur > 1.80m OU puissance totale > 3kWc</option>
                            <option value="mur">Fixation murale</option>
                            <option value="toiture_plate">Sur toiture plate (abri, garage)</option>
                            <option value="toiture_pente">Sur toiture en pente (non typique pour plug-and-play)</option>
                        </select>
                    </div>
                    <div>
                        <label for="gemini-reg-puissance" class="block text-sm font-medium text-gray-700">Puissance totale du kit (Wc) :</label>
                        <input type="number" id="gemini-reg-puissance" name="gemini-reg-puissance" placeholder="Ex: 880" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-[#A1887F] focus:border-[#A1887F]">
                    </div>
                     <div>
                        <label for="gemini-reg-batterie" class="block text-sm font-medium text-gray-700">Le kit inclut-il une batterie de stockage ?</label>
                        <select id="gemini-reg-batterie" name="gemini-reg-batterie" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-[#A1887F] focus:border-[#A1887F]">
                            <option value="non">Non</option>
                            <option value="oui">Oui</option>
                        </select>
                    </div>
                </div>
                <button id="getGeminiRegulationButton" class="w-full bg-[#795548] hover:bg-[#5D4037] text-white font-semibold py-2 px-4 rounded-md transition duration-150 ease-in-out">
                    Clarifier mes D√©marches R√©glementaires ‚ú®
                </button>
                <div id="geminiRegulationLoader" class="mt-4 text-center hidden">
                    <p class="text-sm text-gray-600">Analyse r√©glementaire en cours...</p>
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto mt-2"></div>
                </div>
                <div id="geminiRegulationResult" class="mt-4 p-4 bg-gray-50 rounded-md border border-gray-200 hidden">
                    <h4 class="font-semibold text-gray-800 mb-2">Informations r√©glementaires (bas√©es sur vos indications) :</h4>
                    <div id="geminiRegulationText" class="text-sm text-gray-700 space-y-2"></div>
                </div>
            </div>
            <p class="mt-4 text-sm text-gray-600">Directives de s√©curit√© : utiliser une prise 16A 2P+T conforme, pas de multiprise, disjoncteur diff√©rentiel 30mA, fixation s√©curis√©e contre le vent.</p>
        </section>

        <section id="guide-achat" class="pt-16 -mt-16 mb-12">
            <h2 class="text-2xl md:text-3xl font-bold mb-6 section-title">Crit√®res de S√©lection Cl√©s & Recommandations</h2>
            <p class="mb-6 text-gray-700">Choisir le bon kit n√©cessite une √©valuation de vos besoins et des caract√©ristiques des produits.</p>
            <div class="card p-6">
                <ul class="space-y-3 text-gray-700">
                    <li class="flex items-start"><span class="text-xl mr-3 text-[#795548]">üè†</span> <div><strong>Type de Logement & Espace :</strong> Balcon, jardin, terrasse ? Surface disponible ?</div></li>
                    <li class="flex items-start"><span class="text-xl mr-3 text-[#795548]">‚òÄÔ∏è</span> <div><strong>Exposition & Consommation :</strong> Bon ensoleillement ? Quel est votre talon de consommation ?</div></li>
                    <li class="flex items-start"><span class="text-xl mr-3 text-[#795548]">üî©</span> <div><strong>Syst√®me de Fixation :</strong> Adapt√©, robuste, facile √† installer pour VOUS ? Inclus ou en option ?</div></li>
                    <li class="flex items-start"><span class="text-xl mr-3 text-[#795548]">üí°</span> <div><strong>Panneaux et Onduleur :</strong> Puissance, technologie, marque et garantie de l'onduleur.</div></li>
                    <li class="flex items-start"><span class="text-xl mr-3 text-[#795548]">üõ°Ô∏è</span> <div><strong>Garanties et Support :</strong> Dur√©es ? R√©putation du vendeur (SAV, livraison) ?</div></li>
                    <li class="flex items-start"><span class="text-xl mr-3 text-[#795548]">üí∞</span> <div><strong>Prix vs. Valeur :</strong> Au-del√† du ‚Ç¨/Wc, analysez la qualit√© globale et la durabilit√©.</div></li>
                    <li class="flex items-start"><span class="text-xl mr-3 text-[#795548]">üìú</span> <div><strong>Conformit√© R√©glementaire :</strong> Position du vendeur sur la NF C15-100 ?</div></li>
                </ul>
                <p class="mt-4 text-sm text-gray-600">Le "meilleur" kit est subjectif. Une approche par liste de contr√¥le est conseill√©e. Soyez vigilant quant √† l'√©volution de la norme NF C15-100.</p>
            </div>

            <div class="card p-6 mt-8">
                <h3 class="text-xl font-semibold mb-4 text-[#795548]">‚ú® Assistant de S√©lection Personnalis√©</h3>
                <p class="text-gray-600 mb-4">Besoin d'aide pour affiner votre choix ? R√©pondez √† quelques questions et notre assistant IA vous fournira des pistes de r√©flexion.</p>
                <div class="space-y-4 mb-4">
                    <div>
                        <label for="gemini-logement" class="block text-sm font-medium text-gray-700">Type de logement :</label>
                        <select id="gemini-logement" name="gemini-logement" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-[#A1887F] focus:border-[#A1887F]">
                            <option value="maison">Maison</option>
                            <option value="appartement">Appartement</option>
                        </select>
                    </div>
                    <div>
                        <label for="gemini-installation" class="block text-sm font-medium text-gray-700">Lieu d'installation envisag√© :</label>
                        <select id="gemini-installation" name="gemini-installation" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-[#A1887F] focus:border-[#A1887F]">
                            <option value="sol">Sol / Jardin</option>
                            <option value="toit_plat_accessible">Toit plat accessible (garage, abri)</option>
                            <option value="balcon">Balcon</option>
                            <option value="mur">Mur</option>
                        </select>
                    </div>
                    <div>
                        <label for="gemini-consommation" class="block text-sm font-medium text-gray-700">Votre consommation √©lectrique annuelle (kWh, approximatif) :</label>
                        <input type="number" id="gemini-consommation" name="gemini-consommation" placeholder="Ex: 4500" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-[#A1887F] focus:border-[#A1887F]">
                    </div>
                    <div>
                        <label for="gemini-budget" class="block text-sm font-medium text-gray-700">Votre budget approximatif (optionnel, en ‚Ç¨) :</label>
                        <input type="number" id="gemini-budget" name="gemini-budget" placeholder="Ex: 1000" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-[#A1887F] focus:border-[#A1887F]">
                    </div>
                </div>
                <button id="getGeminiAdviceButton" class="w-full bg-[#795548] hover:bg-[#5D4037] text-white font-semibold py-2 px-4 rounded-md transition duration-150 ease-in-out">
                    Obtenir des Conseils Personnalis√©s ‚ú®
                </button>
                <div id="geminiAdviceLoader" class="mt-4 text-center hidden">
                    <p class="text-sm text-gray-600">Recherche de conseils en cours...</p>
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-[#795548] mx-auto mt-2"></div>
                </div>
                <div id="geminiAdviceResult" class="mt-4 p-4 bg-gray-50 rounded-md border border-gray-200 hidden">
                    <h4 class="font-semibold text-gray-800 mb-2">Pistes de r√©flexion de notre assistant :</h4>
                    <div id="geminiAdviceText" class="text-sm text-gray-700 space-y-2"></div>
                </div>
            </div>
        </section>
        
        <section id="conclusion" class="pt-16 -mt-16">
            <h2 class="text-2xl md:text-3xl font-bold mb-6 section-title">Conclusion et Perspectives</h2>
            <div class="card p-6 bg-[#A1887F] text-white">
                <p class="mb-3">Le march√© fran√ßais des kits solaires plug-and-play est dynamique, offrant des solutions accessibles. La croissance est forte, mais le principal d√©fi r√©side dans l'√©volution r√©glementaire (NF C15-100).</p>
                <p class="mb-3">L'avenir verra probablement des innovations pour des branchements plus s√ªrs et conformes, et un accent continu sur l'efficacit√© des panneaux et la robustesse des fixations. L'int√©gration d'outils d'aide √† la d√©cision bas√©s sur l'IA, comme ceux pr√©sent√©s ici, pourrait √©galement se g√©n√©raliser.</p>
                <p class="font-semibold">Conseils finaux : √âvaluez bien vos besoins, comparez attentivement, renseignez-vous sur la r√©glementation, et privil√©giez les vendeurs r√©put√©s avec de solides garanties.</p>
            </div>
        </section>

    </main>

    <footer class="mt-12 py-8 text-center border-t border-gray-300">
        <p class="text-sm text-gray-600">Application bas√©e sur le rapport "√âtude de March√© et Benchmark Prix des Syst√®mes Solaires Plug-and-Play (2 Panneaux, 800-1000W) en France", dat√© du 23 mai 2025.</p>
        <p class="text-xs text-gray-500 mt-1">Les informations sont fournies √† titre indicatif. Les conseils g√©n√©r√©s par l'IA sont des pistes de r√©flexion et ne remplacent pas l'avis d'un professionnel. Consultez les fiches produits des vendeurs pour les donn√©es les plus r√©centes.</p>
    </footer>

    <script>
        const reportData = {
            acteursCles: [
                { nom: "Sunology", type: "Fabricant/Marque Sp√©cialis√©", details: "S√©ries PLAY et PLAY Max, panneaux bifaciaux, facilit√© d'installation." },
                { nom: "Beem Energy", type: "Fabricant/Marque Sp√©cialis√©", details: "Kits ax√©s sur le design, BeemBox pour suivi." },
                { nom: "Sunethic", type: "Fabricant/Marque Sp√©cialis√©", details: "Kits assembl√©s en France, options toiture (T) et sol/mur (F)." },
                { nom: "Ekwateur", type: "Fournisseur d'√ânergie", details: "Propose aussi des kits solaires, ex: bifacial 500Wc." },
                { nom: "Dualsun", type: "Fabricant/Marque Sp√©cialis√©", details: "Panneaux innovants (FLASH, SPRING), station pliable PREASY." },
                { nom: "Oscaro Power", type: "Fabricant/Marque Sp√©cialis√©", details: "Kit √¥Power Mini avec fixation sol √¥Terra." },
                { nom: "Allo Solar", type: "D√©taillant en Ligne", details: "Large gamme, kit Suncake 800Wc." },
                { nom: "Solarchoc", type: "D√©taillant en Ligne", details: "Prix comp√©titifs, panneaux Jolywood." },
                { nom: "Mon Kit Solaire", type: "D√©taillant en Ligne", details: "Vari√©t√© de kits, diff√©rentes marques." },
                { nom: "Leroy Merlin", type: "Grande Surface de Bricolage", details: "Distribue Sunology, BT Solar, I'M SOLAR." },
                { nom: "Castorama", type: "Grande Surface de Bricolage", details: "Propose kits Sunology et autres." }
            ],
            fixationTypes: [
                { nom: "Montage au Sol", icon: "üè°", details: "Souvent avec lestage (sable, dalles). Simple pour jardins, terrasses. Ex: Sunology PLAY2, Oscaro √¥Terra." },
                { nom: "Montage Mural", icon: "üß±", details: "Optimise l'espace. Peut n√©cessiter plus de bricolage. Ex: Sunology PLAY2, Ekwateur." },
                { nom: "Fixation Balcon", icon: "üåá", details: "Crochets sp√©cifiques, souvent sans per√ßage. Id√©al locataires. Ex: Allo Solar Suncake." },
                { nom: "Montage Toiture (Plate)", icon: "üî©", details: "Pour abris, garages. Vigilance sur √©tanch√©it√©. Ex: Sunethic S√©rie T." }
            ],
            kitComparison: [
                { marque: "Sunology PLAY2 900W", puissance: 900, panneaux: "2x450Wc TopCon Bifacial", microOnduleur: "2x Hoymiles 450W", fixations: "Sol (lest√© inclus), Mur (option)", garanties: "25a/25a", prix: "1148-1198", prixWc: "1.28-1.33" },
                { marque: "Oscaro √¥Power Mini 880W", puissance: 880, panneaux: "2x440Wc JA Solar Bifacial TOPCon", microOnduleur: "APSystems EZ1-M 880W", fixations: "Sol (√¥Terra inclus, √† lester)", garanties: "25a/10-20a (APS)", prix: "590-790", prixWc: "0.67-0.90" },
                { marque: "Sunethic T800 (Toiture)", puissance: 800, panneaux: "2x400Wc Voltec Solar Mono", microOnduleur: "APsystems DS3-L 730VA", fixations: "Toiture (options s√©par√©es)", garanties: "25a/20a", prix: "855-1080 (sans fix.)", prixWc: "1.07-1.35" },
                { marque: "Dualsun PREASY 840W", puissance: 840, panneaux: "2x420Wc Dualsun FLASH TOPCon Bifacial", microOnduleur: "Int√©gr√© (prob. 800W)", fixations: "Sol (ballasts inclus), Mur", garanties: "30a/25a", prix: "~1550-1690", prixWc: "1.85-2.01" },
                { marque: "Allo Solar Suncake 800Wc", puissance: 800, panneaux: "2x400Wc Tier 1", microOnduleur: "Hoymiles 1000W", fixations: "Balcon (crochets), Sol (inclinable)", garanties: "2a (magasin)", prix: "~600 (sans batt.)", prixWc: "~0.75" },
                { marque: "Solarchoc Kit 1000W Jolywood", puissance: 1000, panneaux: "2x500Wc Jolywood Bifacial TOPCon", microOnduleur: "Hoymiles/Deye 1000W", fixations: "SANS SUPPORT (options)", garanties: "25a/12a (Hoymiles)", prix: "~409-495 (sans supp.)", prixWc: "~0.41-0.50" }
            ]
        };

        function populateActeurs() {
            const container = document.getElementById('acteursList');
            if (!container) return;
            reportData.acteursCles.forEach(acteur => {
                const card = `
                    <div class="card p-4">
                        <h4 class="font-semibold text-lg text-[#795548]">${acteur.nom}</h4>
                        <p class="text-sm text-gray-600"><strong>Type:</strong> ${acteur.type}</p>
                        <p class="text-xs text-gray-500 mt-1">${acteur.details}</p>
                    </div>`;
                container.innerHTML += card;
            });
        }

        function populateFixations() {
            const container = document.getElementById('fixationTypes');
            if (!container) return;
            reportData.fixationTypes.forEach(fix => {
                const card = `
                    <div class="card p-4 text-center">
                        <div class="text-3xl mb-2">${fix.icon}</div>
                        <h4 class="font-semibold text-md text-[#795548]">${fix.nom}</h4>
                        <p class="text-xs text-gray-600">${fix.details}</p>
                    </div>`;
                container.innerHTML += card;
            });
        }
        
        function populateKitComparisonTable() {
            const tbody = document.getElementById('kitComparisonTableBody');
            if (!tbody) return;
            reportData.kitComparison.forEach(kit => {
                const row = `
                    <tr>
                        <td class="p-3 font-medium">${kit.marque}</td>
                        <td class="p-3">${kit.puissance}</td>
                        <td class="p-3 text-xs">${kit.panneaux}</td>
                        <td class="p-3 text-xs">${kit.microOnduleur}</td>
                        <td class="p-3 text-xs">${kit.fixations}</td>
                        <td class="p-3 text-xs">${kit.garanties}</td>
                        <td class="p-3">${kit.prix}</td>
                        <td class="p-3">${kit.prixWc}</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        function openTab(event, tabName) {
            let i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.add("hidden");
            }
            tablinks = document.getElementsByClassName("tab-button");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].classList.remove("active");
            }
            document.getElementById(tabName).classList.remove("hidden");
            event.currentTarget.classList.add("active");
        }

        function wrapText(text, maxWidthChars = 16) {
            if (typeof text !== 'string' || text.length <= maxWidthChars) {
                return text;
            }
            const words = text.split(' ');
            const lines = [];
            let currentLine = '';
            for (const word of words) {
                if ((currentLine + word).length > maxWidthChars && currentLine.length > 0) {
                    lines.push(currentLine.trim());
                    currentLine = '';
                }
                currentLine += word + ' ';
            }
            lines.push(currentLine.trim());
            return lines;
        }
        
        const chartTooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            return Array.isArray(label) ? label.join(' ') : label;
        };

        const chartColors = ['#A1887F', '#D4BBA1', '#795548', '#BCAAA4', '#8F9A82'];

        const commonChartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { labels: { color: '#3D3D3D' } },
                tooltip: {
                    enabled: true,
                    mode: 'index',
                    intersect: false,
                    backgroundColor: 'rgba(0,0,0,0.75)',
                    titleColor: 'white',
                    bodyColor: 'white',
                    titleFont: { weight: 'bold'},
                    callbacks: { title: chartTooltipTitleCallback }
                }
            },
            scales: {
                y: { beginAtZero: true, ticks: { color: '#3D3D3D' }, grid: { color: '#E0E0E0' } },
                x: { ticks: { color: '#3D3D3D', callback: function(value, index, ticks) {
                        const label = this.getLabelForValue(value);
                        return wrapText(label);
                    }}, grid: { display: false } }
            }
        };
        
        const commonPieChartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { position: 'top', labels: { color: '#3D3D3D', 
                    generateLabels: function(chart) {
                        const data = chart.data;
                        if (data.labels.length && data.datasets.length) {
                            return data.labels.map(function(label, i) {
                                const meta = chart.getDatasetMeta(0);
                                const style = meta.controller.getStyle(i);
                                return {
                                    text: wrapText(Array.isArray(label) ? label.join(' ') : label),
                                    fillStyle: style.backgroundColor,
                                    strokeStyle: style.borderColor,
                                    lineWidth: style.borderWidth,
                                    hidden: isNaN(data.datasets[0].data[i]) || meta.data[i].hidden,
                                    index: i
                                };
                            });
                        }
                        return [];
                    }
                }},
                tooltip: {
                    backgroundColor: 'rgba(0,0,0,0.75)', titleColor: 'white', bodyColor: 'white',
                    callbacks: {
                        title: chartTooltipTitleCallback,
                        label: function(context) {
                            let label = context.label || '';
                            if (Array.isArray(label)) label = label.join(' ');
                            if (label) label += ': ';
                            if (context.parsed !== null) label += context.parsed + '%';
                            return label;
                        }
                    }
                }
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            populateActeurs();
            populateFixations();
            populateKitComparisonTable();

            if (document.getElementById('panelPowerChart')) {
                new Chart(document.getElementById('panelPowerChart').getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: ['400 Wc', '420-450 Wc', '500 Wc'],
                        datasets: [{
                            label: 'R√©partition Puissance Panneaux (%)',
                            data: [35, 45, 20], 
                            backgroundColor: chartColors.slice(0,3),
                        }]
                    },
                    options: commonChartOptions
                });
            }

            if (document.getElementById('panelTechChart')) {
                new Chart(document.getElementById('panelTechChart').getContext('2d'), {
                    type: 'doughnut',
                    data: {
                        labels: [wrapText('Monocristallin'), wrapText('Bifacial'), wrapText('TOPCon'), wrapText('Autres (Bi-verre, etc.)')],
                        datasets: [{
                            label: 'Technologies Panneaux',
                            data: [40, 30, 20, 10], 
                            backgroundColor: chartColors,
                            hoverOffset: 4
                        }]
                    },
                    options: commonPieChartOptions
                });
            }
            
            if (document.getElementById('pricePerWcChart')) {
                new Chart(document.getElementById('pricePerWcChart').getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: [wrapText('Entr√©e de Gamme (<0.7‚Ç¨/Wc)'), wrapText('Milieu de Gamme (0.7-1.2‚Ç¨/Wc)'), wrapText('Premium (>1.2‚Ç¨/Wc)')],
                        datasets: [{
                            label: 'Exemples de Prix par Watt cr√™te (‚Ç¨/Wc)',
                            data: [0.55, 0.95, 1.45], 
                            backgroundColor: chartColors.slice(0,3),
                        }]
                    },
                    options: commonChartOptions
                });
            }

            const sections = document.querySelectorAll('main section');
            const navLinks = document.querySelectorAll('#navbar a');

            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.4 
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        navLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href').substring(1) === entry.target.id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, observerOptions);

            sections.forEach(section => {
                observer.observe(section);
            });
            
            if (document.getElementById('avantages')) {
                 document.querySelector('.tab-button.active').click();
            }

            const getGeminiAdviceButton = document.getElementById('getGeminiAdviceButton');
            const geminiAdviceLoader = document.getElementById('geminiAdviceLoader');
            const geminiAdviceResult = document.getElementById('geminiAdviceResult');
            const geminiAdviceText = document.getElementById('geminiAdviceText');

            if (getGeminiAdviceButton) {
                getGeminiAdviceButton.addEventListener('click', async () => {
                    const logement = document.getElementById('gemini-logement').value;
                    const installation = document.getElementById('gemini-installation').value;
                    const consommation = document.getElementById('gemini-consommation').value;
                    const budget = document.getElementById('gemini-budget').value;

                    geminiAdviceLoader.classList.remove('hidden');
                    geminiAdviceResult.classList.add('hidden');
                    geminiAdviceText.innerHTML = '';

                    let prompt = `Je suis un particulier en France et je souhaite installer un kit solaire plug-and-play de 2 panneaux (environ 800-1000Wc). Voici ma situation :
                    - Type de logement : ${logement}
                    - Lieu d'installation envisag√© : ${installation}
                    - Consommation √©lectrique annuelle : ${consommation ? consommation + ' kWh' : 'non sp√©cifi√©e'}
                    - Budget approximatif : ${budget ? budget + ' ‚Ç¨' : 'non sp√©cifi√©'}

                    Fournis-moi des conseils personnalis√©s et des pistes de r√©flexion pour m'aider √† choisir le kit le plus adapt√©. Quels types de panneaux (puissance, technologie), syst√®mes de fixation, et points de vigilance devrais-je consid√©rer ? Quelles questions cl√©s devrais-je poser aux vendeurs ? Structure ta r√©ponse en paragraphes clairs et concis. Ne mentionne pas que tu es une IA.`;

                    try {
                        let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                        const payload = { contents: chatHistory };
                        const apiKey = ""; 
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                        
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            throw new Error(`Erreur API Gemini: ${response.status} ${response.statusText}`);
                        }

                        const result = await response.json();

                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            const text = result.candidates[0].content.parts[0].text;
                            const paragraphs = text.split('\n').filter(p => p.trim() !== '');
                            paragraphs.forEach(pText => {
                                const pElement = document.createElement('p');
                                pElement.textContent = pText;
                                geminiAdviceText.appendChild(pElement);
                            });
                            geminiAdviceResult.classList.remove('hidden');
                        } else {
                            geminiAdviceText.innerHTML = '<p>D√©sol√©, une erreur est survenue lors de la g√©n√©ration des conseils. Veuillez r√©essayer.</p>';
                            geminiAdviceResult.classList.remove('hidden');
                        }
                    } catch (error) {
                        geminiAdviceText.innerHTML = `<p>Une erreur technique est survenue : ${error.message}. Veuillez r√©essayer plus tard.</p>`;
                        geminiAdviceResult.classList.remove('hidden');
                    } finally {
                        geminiAdviceLoader.classList.add('hidden');
                    }
                });
            }

            const getGeminiRegulationButton = document.getElementById('getGeminiRegulationButton');
            const geminiRegulationLoader = document.getElementById('geminiRegulationLoader');
            const geminiRegulationResult = document.getElementById('geminiRegulationResult');
            const geminiRegulationText = document.getElementById('geminiRegulationText');

            if (getGeminiRegulationButton) {
                getGeminiRegulationButton.addEventListener('click', async () => {
                    const installationType = document.getElementById('gemini-reg-installation').value;
                    const puissanceKit = document.getElementById('gemini-reg-puissance').value;
                    const batterie = document.getElementById('gemini-reg-batterie').value;

                    geminiRegulationLoader.classList.remove('hidden');
                    geminiRegulationResult.classList.add('hidden');
                    geminiRegulationText.innerHTML = '';

                    let prompt = `Je pr√©vois d'installer un kit solaire plug-and-play en France. Voici les d√©tails de mon projet :
                    - Type d'installation : ${installationType.replace(/_/g, ' ')}
                    - Puissance totale du kit : ${puissanceKit ? puissanceKit + ' Wc' : 'non sp√©cifi√©e'}
                    - Le kit inclut une batterie : ${batterie}

                    Peux-tu m'expliquer de mani√®re simple et claire les d√©marches administratives probables (D√©claration Pr√©alable en mairie, Convention avec Enedis (CACSI), n√©cessit√© d'un CONSUEL) pour cette configuration ? Pr√©cise les conditions qui s'appliquent. Souligne √©galement l'importance de la norme NF C15-100 et les certifications requises pour le mat√©riel (ex: VDE0126-1-1 / EN50549 pour l'onduleur). Structure ta r√©ponse en paragraphes clairs et concis. Ne mentionne pas que tu es une IA.`;
                    
                    try {
                        let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                        const payload = { contents: chatHistory };
                        const apiKey = ""; 
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                        
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            throw new Error(`Erreur API Gemini: ${response.status} ${response.statusText}`);
                        }

                        const result = await response.json();

                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            const text = result.candidates[0].content.parts[0].text;
                            const paragraphs = text.split('\n').filter(p => p.trim() !== '');
                            paragraphs.forEach(pText => {
                                const pElement = document.createElement('p');
                                pElement.textContent = pText;
                                geminiRegulationText.appendChild(pElement);
                            });
                            geminiRegulationResult.classList.remove('hidden');
                        } else {
                            geminiRegulationText.innerHTML = '<p>D√©sol√©, une erreur est survenue lors de la clarification r√©glementaire. Veuillez r√©essayer.</p>';
                            geminiRegulationResult.classList.remove('hidden');
                        }
                    } catch (error) {
                        geminiRegulationText.innerHTML = `<p>Une erreur technique est survenue : ${error.message}. Veuillez r√©essayer plus tard.</p>`;
                        geminiRegulationResult.classList.remove('hidden');
                    } finally {
                        geminiRegulationLoader.classList.add('hidden');
                    }
                });
            }
        });
    </script>
</body>
</html>
